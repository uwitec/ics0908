<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Account">
	<select id="selectAccountCount" resultClass="com.mydomain.bean.baseset.AccountBean">
		SELECT
		count(*) as countValue
		FROM ACCOUNT,PERSON,BANK
		WHERE ACCOUNT.ISENABLED!=0
		AND 
		PERSON.PERSONCODE=ACCOUNT.PERSONCODE
		AND
		ACCOUNT.BANKCODE=BANK.BANKCODE
		AND
		( locate(#accountNumber#,ACCOUNT.ACCOUNTNUMBER)>0
		OR locate(#accountCode#,ACCOUNTCODE)>0
		OR locate(#accountName#,ACCOUNTNAME)>0 
		OR locate(#accountType#,ACCOUNTTYPE)>0 
		OR locate(#personName#,PERSON.PERSONNAME)>0 
		OR locate(#bankName#,BANK.BANKNAME)>0)
	</select>
	<select id="selectAccountDef" resultClass="com.mydomain.bean.baseset.AccountBean">
		SELECT
		ACCOUNTCODE,
		ACCOUNTNUMBER,
		ACCOUNTNAME,
		ACCOUNTTYPE,
		ACCOUNT.PERSONCODE,
		PERSON.PERSONNAME,
		ACCOUNT.BANKCODE,
		BANK.BANKNAME
		FROM ACCOUNT,PERSON,BANK
		WHERE ACCOUNT.ISENABLED!=0
		AND 
		PERSON.PERSONCODE=ACCOUNT.PERSONCODE
		AND
		ACCOUNT.BANKCODE=BANK.BANKCODE
		AND
		( locate(#accountNumber#,ACCOUNT.ACCOUNTNUMBER)>0
		OR locate(#accountCode#,ACCOUNTCODE)>0
		OR locate(#accountName#,ACCOUNTNAME)>0 
		OR locate(#accountType#,ACCOUNTTYPE)>0 
		OR locate(#personName#,PERSON.PERSONNAME)>0 
		OR locate(#bankName#,BANK.BANKNAME)>0)
		limit #startValue#,#endValue#
	</select>
	<select id="getAccountBean" parameterClass="String" resultClass="com.mydomain.bean.baseset.AccountBean">
		SELECT
		ACCOUNTCODE,
		ACCOUNTNUMBER,
		ACCOUNTNAME,
		ACCOUNTTYPE,
		ACCOUNT.PERSONCODE,
		PERSON.PERSONNAME,
		ACCOUNT.BANKCODE,
		BANK.BANKNAME
		FROM ACCOUNT,PERSON,BANK
		WHERE ACCOUNT.ISENABLED=1
		AND 
		PERSON.PERSONCODE=ACCOUNT.PERSONCODE
		AND
		ACCOUNT.BANKCODE=BANK.BANKCODE
		AND
		ACCOUNT.ACCOUNTCODE=#accountCode#
	</select>
	<insert id="insertAccountBean" parameterClass="com.mydomain.bean.baseset.AccountBean">
		INSERT INTO ACCOUNT
		(ACCOUNTCODE,ACCOUNTNUMBER,ACCOUNTNAME,ACCOUNTTYPE,PERSONCODE,BANKCODE,ISENABLED) 
		VALUES
		(#accountCode#,#accountNumber#,#accountName#,#accountType#,#personCode#,#bankCode#,1)
	</insert>
	<update id="updateAccountBean" parameterClass="com.mydomain.bean.baseset.AccountBean">
		UPDATE ACCOUNT
		SET 
		ACCOUNTNUMBER=#accountNumber#,
		ACCOUNTNAME=#accountName#,
		ACCOUNTTYPE=#accountType#,
		PERSONCODE=#personCode#,
		BANKCODE=#bankCode#,
		ISENABLED=1
		WHERE ACCOUNTCODE=#accountCode#
	</update>
	<delete id="deleteAccountBean" parameterClass="com.mydomain.bean.baseset.AccountBean">
	UPDATE ACCOUNT
		SET 
		ISENABLED=0
		WHERE ACCOUNTCODE=#accountCode#
	</delete> 
</sqlMap>