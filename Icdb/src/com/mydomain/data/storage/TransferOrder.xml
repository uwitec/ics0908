<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="TransferOrder">
	<select id="selectTransferPersonCount" resultClass="com.mydomain.bean.storage.TransferOrderBean">
	select
	count(*) as countValue
	from TransferOrder as t,person as p
	where 
	transferState!=0 and 
	p.personCode=t.transferOrderPerson and t.transferOrderPerson=#transferOrderPerson# and
	locate(#transferOrderType#,transferOrderType)>0 and
	locate(#transferOrderCode#,transferOrderCode)>0
	</select>
	<select id="selectTransferPersonDef" resultClass="com.mydomain.bean.storage.TransferOrderBean">
	select
	t.transferOrderCode,
	t.transferOrderTime,
	t.transferOrderType,
	t.transferOrderCredence,
	t.transferOrderChecker,
	t.transferOrderPerson,
	t.transferState,
	t.storehouseCode,
	p.personName
	from TransferOrder as t,person as p
	where 
	t.transferState!=0 and 
	p.personCode=t.transferOrderPerson and t.transferOrderPerson=#transferOrderPerson# and
	locate(#transferOrderType#,transferOrderType)>0 and
	locate(#transferOrderCode#,transferOrderCode)>0
	limit #startValue#,#endValue# 
	</select>
	<select id="selectTransferHisCount" resultClass="com.mydomain.bean.storage.TransferOrderBean">
	select
	count(*) as countValue
	from TransferOrder as t,person as p
	where 
	transferState!=0 and 
	p.personCode=t.transferOrderPerson and
	locate(#transferOrderType#,transferOrderType)>0 and
	locate(#transferOrderCode#,transferOrderCode)>0
	</select>
	<select id="selectTransferHisDef" resultClass="com.mydomain.bean.storage.TransferOrderBean">
	select
	t.transferOrderCode,
	t.transferOrderTime,
	t.transferOrderType,
	t.transferOrderCredence,
	t.transferOrderChecker,
	t.transferOrderPerson,
	t.transferState,
	t.storehouseCode,
	p.personName
	from TransferOrder as t,person as p
	where 
	transferState!=0 and 
	p.personCode=t.transferOrderPerson and
	locate(#transferOrderType#,transferOrderType)>0 and
	locate(#transferOrderCode#,transferOrderCode)>0
	limit #startValue#,#endValue# 
	</select>
	<select id="getTransferBean"  resultClass="com.mydomain.bean.storage.TransferOrderBean">	
	select
	t.transferOrderCode,
	t.transferOrderTime,
	t.transferOrderType,
	t.transferOrderCredence,
	t.transferOrderChecker,
	t.transferOrderPerson,
	t.transferState,
	t.storehouseCode,
	p.personName
	from TransferOrder as t,person as p
	where 
	t.transferState!=0 and p.personcode=t.transferOrderPerson and
	t.transferOrderCode=#transferOrderCode#
	</select>
	<insert id="insertTransferBean" parameterClass="com.mydomain.bean.storage.TransferOrderBean">
	insert into TransferOrder(transferOrderCode,transferOrderTime,transferOrderType,
	transferOrderCredence,transferOrderChecker,transferOrderPerson,transferState,storehouseCode)
	values
	(#transferOrderCode#,#transferOrderTime#,#transferOrderType#,#transferOrderCredence#,
	#transferOrderChecker#,#transferOrderPerson#,#transferState#,#storehouseCode#)
	</insert>
	<update id="updateTransferBean" parameterClass="com.mydomain.bean.storage.TransferOrderBean">
	update TransferOrder
	set 
	transferOrderTime=#transferOrderTime#,
	transferOrderType=#transferOrderType#,
	transferOrderCredence=#transferOrderCredence#,
	transferOrderChecker=#transferOrderChecker#,
	transferOrderPerson=#transferOrderPerson#,
	transferState=#transferState#
	where transferOrderCode=#transferOrderCode#
	</update>
	<delete id="deleteTransferBean" parameterClass="com.mydomain.bean.storage.TransferOrderBean">
	update TransferOrder
	set 
	transferState=0
	where transferOrderCode=#transferOrderCode#
	</delete> 
</sqlMap>