<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="StockInCheckMateriel">
	<typeAlias alias="materiel"
		type="com.mydomain.bean.storage.MaterielBean" />
	<typeAlias alias="materielExt"
		type="com.mydomain.bean.storage.MaterielBeanExt" />

	<sql id="MATERIEL_COMMON_CONDITION">

			<isNotEmpty property="materielCode" prepend="and">
				m.materielCode = #materielCode#
			</isNotEmpty>
			<isNotEmpty property="materielName" prepend="and">
				m.materielName = #materielName#
			</isNotEmpty>
			<isNotEmpty property="materielPrice" prepend="and">
				m.materielPrice = #materielPrice#
			</isNotEmpty>
			<isNotEmpty property="materielMadeIn" prepend="and">
				m.materielMadeIn = #materielMadeIn#
			</isNotEmpty>
			<isNotEmpty property="materielMaxStore" prepend="and">
				m.materielMaxStore =#materielMaxStore#
			</isNotEmpty>
			<isNotEmpty property="materielMinStore" prepend="and">
				m.materielMinStore = #materielMinStore#
			</isNotEmpty>
			<isNotEmpty property="materielSpell" prepend="and">
				m.materielSpell = #materielSpell#
			</isNotEmpty>
			<isNotEmpty property="isEnabled">
				m.isEnabled = #isEnabled#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="jsonField">
				m.jsonField = #jsonField#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="materielSize">
				m.materielSize = #materielSize#
			</isNotEmpty>
			<isNotEmpty property="materielABC" prepend="and">
				m.materielABC = #materielABC#
			</isNotEmpty>
			<isNotNull property="materielIds" prepend="and">
				m.materielCode not in
				<iterate open="(" close=")" conjunction=","
					property="materielIds">
					#materielIds[]#
				</iterate>
			</isNotNull>

	</sql>

	<sql id="MATERIEL_COMMON_SELECT">
		<![CDATA[
			select m.materielCode, m.materielName, m.materielMadeIn,
			m.materielPrice, m.materielMaxStore, m.materielMinStore,
			m.materielSpell, m.isEnabled, m.jsonField, m.materielSize, m.materielABC
			from Materiel m
		]]>
	</sql>

	<select id="SHOW_MATERIEL" resultClass="materiel">
		<include refid="MATERIEL_COMMON_SELECT" />
		<dynamic prepend="where">
			<include refid="MATERIEL_COMMON_CONDITION" />
		</dynamic>
	</select>

	<select id="SHOW_MATERIEL_AND_CARGOSPACE" resultClass="materielExt">
		<![CDATA[
			select m.materielCode, m.materielName, m.materielMadeIn,
			m.materielPrice, m.materielMaxStore, m.materielMinStore,
			m.materielSpell, m.isEnabled, m.jsonField, m.materielSize, m.materielABC,s.cargoSpaceCode,
			s.stockPrice,s.stockAmount
			from Materiel m,Stock s where m.materielCode = s.materielCode
		]]>
		<include refid="MATERIEL_COMMON_CONDITION"/>
	</select>
	<insert id="ADD_MATERIEL">
		<![CDATA[
			insert into Materiel(
			    materielCode,
				materielName,
				materielMadeIn,
				materielPrice,
				materielMaxStore,
				materielMinStore,
				materielSpell,
				isEnabled,
				jsonField,
				materielSize,
				materielABC
			 )values(
			  	#materielCode#,
				#materielName#,
				#materielMadeIn#,
				#materielPrice#,
				#materielMaxStore#,
				#materielMinStore#,
				#materielSpell#,
				#isEnabled#,
				#jsonField#,
				materielSize,
				materielABC
			)
		]]>
	</insert>


</sqlMap>