<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap      
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Storehouse">
<select id="selectStorehousecount" resultClass="com.mydomain.bean.baseset.StorehouseBean">
		SELECT 
		count(*) as countValue
		FROM STOREHOUSE ,
		(SELECT 
		PERSON.PERSONNAME,
		PERSON.PERSONCODE,
		EMPLOYEE.EMPLOYEECODE
		FROM PERSON,EMPLOYEE
		WHERE PERSON.PERSONCODE=EMPLOYEE.PERSONCODE) AS PE 
		WHERE PE.EMPLOYEECODE=STOREHOUSE.EMPLOYEECODE
		AND STOREHOUSE.ISENABLED!=0
		AND (
		   locate(#storehouseName#,STOREHOUSE.STOREHOUSENAME)>0
		or locate(#storehouseCode#,STOREHOUSE.STOREHOUSECODE)>0
		or locate(#storehouseAddress#,STOREHOUSE.STOREHOUSEADDRESS)>0 
		or locate(#storehouseDefaultCargo#,STOREHOUSE.STOREHOUSEDEFAULTCARGO)>0
		or locate(#personName#,PE.PERSONNAME)>0)
</select>
	<select id="selectStorehouseDef" resultClass="com.mydomain.bean.baseset.StorehouseBean">
		SELECT 
		STOREHOUSE.STOREHOUSECODE,
		STOREHOUSE.STOREHOUSENAME,
		STOREHOUSE.STOREHOUSEADDRESS,
		STOREHOUSE.STOREHOUSEDEFAULTCARGO,
		STOREHOUSE.EMPLOYEECODE,
		PE.PERSONNAME
		FROM STOREHOUSE ,
		(SELECT 
		PERSON.PERSONNAME,
		PERSON.PERSONCODE,
		EMPLOYEE.EMPLOYEECODE
		FROM PERSON,EMPLOYEE
		WHERE PERSON.PERSONCODE=EMPLOYEE.PERSONCODE) AS PE 
		WHERE PE.EMPLOYEECODE=STOREHOUSE.EMPLOYEECODE
		AND STOREHOUSE.ISENABLED!=0
		AND (
		   locate(#storehouseName#,STOREHOUSE.STOREHOUSENAME)>0
		or locate(#storehouseCode#,STOREHOUSE.STOREHOUSECODE)>0
		or locate(#storehouseAddress#,STOREHOUSE.STOREHOUSEADDRESS)>0 
		or locate(#storehouseDefaultCargo#,STOREHOUSE.STOREHOUSEDEFAULTCARGO)>0
		or locate(#personName#,PE.PERSONNAME)>0)
		limit #startValue#,#endValue#
	</select>
	<select id="seletStorehouseALL" resultClass="com.mydomain.bean.baseset.StorehouseBean">
		SELECT 
		STOREHOUSE.STOREHOUSECODE,
		STOREHOUSE.STOREHOUSENAME,
		STOREHOUSE.STOREHOUSEADDRESS,
		STOREHOUSE.STOREHOUSEDEFAULTCARGO,
		STOREHOUSE.EMPLOYEECODE,
		PE.PERSONNAME
		FROM STOREHOUSE ,
		(SELECT 
		PERSON.PERSONNAME,
		PERSON.PERSONCODE,
		EMPLOYEE.EMPLOYEECODE
		FROM PERSON,EMPLOYEE
		WHERE PERSON.PERSONCODE=EMPLOYEE.PERSONCODE) AS PE 
		WHERE PE.EMPLOYEECODE=STOREHOUSE.EMPLOYEECODE
		AND STOREHOUSE.ISENABLED!=0
	</select>
	<select id="getStorehouseBean" parameterClass="String" resultClass="com.mydomain.bean.baseset.StorehouseBean">
		SELECT 
		STOREHOUSE.STOREHOUSECODE,
		STOREHOUSE.STOREHOUSENAME,
		STOREHOUSE.STOREHOUSEADDRESS,
		STOREHOUSE.STOREHOUSEDEFAULTCARGO,
		STOREHOUSE.EMPLOYEECODE,
		PE.PERSONNAME
		FROM STOREHOUSE ,
		(SELECT 
		PERSON.PERSONNAME,
		PERSON.PERSONCODE,
		EMPLOYEE.EMPLOYEECODE
		FROM PERSON,EMPLOYEE
		WHERE PERSON.PERSONCODE=EMPLOYEE.PERSONCODE) AS PE 
		WHERE PE.EMPLOYEECODE=STOREHOUSE.EMPLOYEECODE
		AND STOREHOUSE.ISENABLED!=0
		AND STOREHOUSE.STOREHOUSECODE=#storehouseCode#
	</select>
	<insert id="insertStorehouseBean" parameterClass="com.mydomain.bean.baseset.StorehouseBean">
		INSERT INTO STOREHOUSE
		(STOREHOUSECODE,STOREHOUSENAME,STOREHOUSEADDRESS,STOREHOUSEDEFAULTCARGO,EMPLOYEECODE,ISENABLED)
		VALUES
		(#storehouseCode#,#storehouseName#,#storehouseAddress#,#storehouseDefaultCargo#,#employeeCode#,1)
	</insert>
	<update id="updateStorehouseBean" parameterClass="com.mydomain.bean.baseset.StorehouseBean">
		UPDATE STOREHOUSE
		SET	
		STOREHOUSENAME=#storehouseName#,
		STOREHOUSEADDRESS=#storehouseAddress#,
		STOREHOUSEDEFAULTCARGO=#storehouseDefaultCargo#,
		EMPLOYEECODE=#employeeCode#,
		ISENABLED=#isEnabled#
		WHERE STOREHOUSECODE=#storehouseCode#
	</update>
	<delete id="deleteStorehouseBean" parameterClass="com.mydomain.bean.baseset.StorehouseBean">
		UPDATE STOREHOUSE
		SET	
		ISENABLED=0
		WHERE STOREHOUSCODE=#storehouseCode#
	</delete>
</sqlMap>